---
layout: default
nav_order: 10
parent: Azure
grand_parent: Deployment
permalink: /deployment/azure/aks
title: AKS
tags: ["deployment", "kubernetes", "azure", "aks"]
---

## On this page
{: .no_toc .text-delta }
1. TOC
{:toc}

## What are Kubernetes and Azure Kubernetes Services (AKS)?

> Kubernetes is open-source software that helps deploy and manage containerized applications at scale. It orchestrates a cluster of Azure virtual machines, schedules containers, automatically manages service discovery, incorporates load balancing, and tracks resource allocation. It also checks the health of individual resources and heals apps with auto-restart and auto-replication.
> AKS provides a managed Kubernetes service with automated provisioning, upgrading, monitoring, and on-demand scaling. (Source: [https://azure.microsoft.com/en-us/services/kubernetes-service/#faq](https://azure.microsoft.com/en-us/services/kubernetes-service/#faq))

There are several ways to install an AKS cluster: ARM templates, Azure CLI, Terraform - the choice is yours.

To deploy Azure resources for CluedIn, you need to provide CluedIn Partner GUID (`e64d9978-e282-4d1c-9f2e-0eccb50582e4
`). The way you provide the Partner GUID depends on the way you deploy AKS: 

## Deploy AKS

### Azure CLI

Walkthrough (Microsoft Docs): [https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough](https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough)
Microsoft's instructions to deploy the Partner GUID: [https://docs.microsoft.com/en-us/azure/marketplace/azure-partner-customer-usage-attribution#example-azure-cli](https://docs.microsoft.com/en-us/azure/marketplace/azure-partner-customer-usage-attribution#example-azure-cli)

To install the Partner GUID, you need to add an environment variable to your terminal session.

Bash:
```
export AZURE_HTTP_USER_AGENT='pid-e64d9978-e282-4d1c-9f2e-0eccb50582e4' ;
echo AZURE_HTTP_USER_AGENT # should print pid-e64d9978-e282-4d1c-9f2e-0eccb50582e4
```

PowerShell:
```
$env:AZURE_HTTP_USER_AGENT='pid-e64d9978-e282-4d1c-9f2e-0eccb50582e4' ;
$env:AZURE_HTTP_USER_AGENT # should print pid-e64d9978-e282-4d1c-9f2e-0eccb50582e4
```

### ARM Template

Walkthrough (Microsoft Docs): [https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough-rm-template](https://docs.microsoft.com/en-us/azure/aks/kubernetes-walkthrough-rm-template)

Walkthrough with Partner GUID (CluedIn Docs): [https://documentation.cluedin.net/kb/azure-customer-usage-attribution](https://documentation.cluedin.net/kb/azure-customer-usage-attribution).

Microsoft's instructions to deploy the Partner GUID: [https://docs.microsoft.com/en-us/azure/marketplace/azure-partner-customer-usage-attribution#add-a-guid-to-a-resource-manager-template](https://docs.microsoft.com/en-us/azure/marketplace/azure-partner-customer-usage-attribution#add-a-guid-to-a-resource-manager-template)

To deploy with the Partner GUID, you only need to add this deployment to the resources section:

```
    { 
      "apiVersion": "2020-06-01",
      "name": "pid-e64d9978-e282-4d1c-9f2e-0eccb50582e4",
      "type": "Microsoft.Resources/deployments",
      "properties": {
          "mode": "Incremental",
          "template": {
              "$schema": "https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#",
              "contentVersion": "1.0.0.0",
              "resources": []
          }
      }
    }, 
```

## Sizing

The recommended size of the AKS cluster depends on the amount of data you plan to process. You can always scale it up and down as you need.

### More than five millions of records

<table>
    <tr>
        <th>Nodepool</th>
        <th>Nodepool Type</th>
        <th>Nodepool Size</th>
        <th>Node</th>
        <th>Workload</th>
        <th>CPU Request (Cores)</th>
        <th>RAM Request</th>
        <th>CPU Limit (Cores)</th>
        <th>RAM Limit</th>
        <th>Disk Type</th>
        <th>Disk Size</th>
        <th>Purpose</th>
    </tr>
    <tr>
        <td rowspan="2">Processing</td>
        <td rowspan="2">F16s_v2</td>
        <td rowspan="2">15.7 Cores, 28 GB (Allocatable)</td>
        <td>1</td>
        <td>CluedIn Processing</td>
        <td>14</td>
        <td>20GB</td>
        <td>15</td>
        <td>24GB</td>
        <td>-</td>
        <td>-</td>
        <td>Processing incoming and outgoing master data</td>
    </tr>
    <tr>
        <td>2</td>
        <td>CluedIn Processing</td>
        <td>14</td>
        <td>20GB</td>
        <td>15</td>
        <td>24GB</td>
        <td>-</td>
        <td>-</td>
        <td>Additional processing for historical ingestion (temporary)</td>
    </tr>
</table>

### Less than five millions of records

